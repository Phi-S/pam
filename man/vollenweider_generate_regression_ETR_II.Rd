% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/vollenweider.R
\name{vollenweider_generate_regression_ETR_II}
\alias{vollenweider_generate_regression_ETR_II}
\title{Generate Regression for ETR II using the Vollenweider Model (1965)}
\usage{
vollenweider_generate_regression_ETR_II(
  data,
  pmax_start_value = vollenweider_default_start_value_pmax,
  a_start_value = vollenweider_default_start_value_a,
  alpha_start_value = vollenweider_default_start_value_alpha,
  n_start_value = vollenweider_default_start_value_n
)
}
\arguments{
\item{data}{A `data.table` containing the input data from \link[pam]{read_dual_pam_data}}

\item{alpha_start_value}{Numeric. The starting value for the parameter \eqn{alpha}
in the model. Defaults to \code{alpha_start_values_vollenweider_default}.
#' @param n_start_value Numeric. The starting value for the parameter \eqn{n}
in the model. Defaults to \code{n_start_values_vollenweider_default}.}

\item{etr_type}{A character string specifying the column name of the
response variable (in this case: ETR II) to be used in the model.}

\item{pmax_start_value_vollenweider}{Numeric. The starting value for the parameter \eqn{pmax}
in the model. Defaults to \code{pmax_start_values_vollenweider_default}.}

\item{a_start_value_vollenweider}{Numeric. The starting value for the parameter \eqn{a}
in the model. Defaults to \code{a_start_values_vollenweider_default}.}
}
\value{
A list containing the following elements:
\describe{
  \item{etr_regression_data}{A `data.table` with the predicted values of ETR II to each PAR based on the fitted model.}
  \item{sdiff}{The deviation between the actual and predicted ETR values.}
  \item{pmax}{The maximum electron transport rate without photoinhibition.}
  \item{a}{The obtained parameter \eqn{a}.}
  \item{alpha}{The obtained parameter \eqn{alpha}.}
  \item{n}}{The obtained parameter \eqn{n}.}
  \item{popt}{The maximum electron transport rate with photoinhibition. A function computes predicted photosynthetic rates for each PAR value and tracks the maximum rate observed. This eliminates the need to determine the partitioning factor for each value of n in advance.}
  \item{ik}{PAR where the transition point from light limitation to light saturation is achieved without photoinhibition, calculated as \eqn(ik = 1 / a)}
  \item{iik}{PAR where the transition point from light limitation to light saturation is achieved with photoinhibition, calculated as \eqn(iik = (ik * popt) / pmax)}
  \item{pmax_popt_and_ik_iik_ratio}{Ratio of pmax to popt and ik to iik, calculated as \eqn(pmax_popt_and_ik_iik_ratio = ik / iik)}
}
\description{
This function generates a regression model based on the Vollenweider
formula. Original naming conventions from the publication are used.
}
\details{
This function uses non-linear least squares fitting to estimate the parameters
for the Vollenweider model, which describes the relationship between PAR and
ETR. The model used is:

\eqn{p = pmax * (((a * i) / (sqrt(1 + (a * i)^2))) * (1 / (sqrt(1 + (alpha * i)^2)^n))}

It is valid: i = PAR; p = ETR
}
\references{
Vollenweider, R. A. (1965). Calculation models of photosynthesis-depth curves
and some implications regarding day rate estimates in primary production measurements,
p. 427-457. In C. R. Goldman [ed.], *Primary Productivity in Aquatic Environments*.
Mem. Ist. Ital. Idrobiol., 18 Suppl., University of California Press, Berkeley.
}
\seealso{
\code{\link{nlsLM}}, \code{\link{minpack.lm}}
}
